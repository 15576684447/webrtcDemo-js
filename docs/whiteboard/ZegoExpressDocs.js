!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){"use strict";var n=r(11),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},deepMerge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]="object"==typeof r?e({},r):r}for(var n=0,i=arguments.length;n<i;n++)u(arguments[n],r);return t},extend:function(e,t,r){return u(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,r){var n;e.exports=(n=n||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},i=n.lib={},o=i.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],i=function(t){t=t;var r=987654321,n=4294967295;return function(){var i=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=i(4294967296*(r||e.random()));r=987654071*s(),n.push(4294967296*s()|0)}return new a.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},f=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,s=i/(4*o),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var f=0;f<c;f+=o)this._doProcessBlock(n,f);var l=n.splice(0,c);r.sigBytes-=u}return new a.init(l,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(i.Hasher=l.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),n)},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderTypeEnum=t.ExpectFileTypeEnum=t.FileTypeEnum=t.PPTSuffixEnum=t.WORDSuffixEnum=t.EXCELSuffixEnum=t.PDFSuffixEnum=t.IMGSuffixEnum=t.TXTSuffixEnum=t.UploadStatus=void 0,function(e){e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.WAITING=4]="WAITING",e[e.CONVERTING=8]="CONVERTING",e[e.CONVERTED=16]="CONVERTED",e[e.CONVERTFAIL=32]="CONVERTFAIL"}(t.UploadStatus||(t.UploadStatus={})),function(e){e[e.TXT=0]="TXT",e[e.MD=1]="MD",e[e.C=2]="C",e[e.CPP=3]="CPP",e[e.H=4]="H",e[e.HPP=5]="HPP",e[e.PY=6]="PY",e[e.JS=7]="JS",e[e.XML=8]="XML"}(t.TXTSuffixEnum||(t.TXTSuffixEnum={})),function(e){e[e.PNG=0]="PNG",e[e.JPEG=1]="JPEG",e[e.JPG=2]="JPG",e[e.BMP=3]="BMP"}(t.IMGSuffixEnum||(t.IMGSuffixEnum={})),function(e){e[e.PDF=0]="PDF"}(t.PDFSuffixEnum||(t.PDFSuffixEnum={})),function(e){e[e.XLSX=0]="XLSX",e[e.XLS=1]="XLS"}(t.EXCELSuffixEnum||(t.EXCELSuffixEnum={})),function(e){e[e.DOC=0]="DOC",e[e.DOCX=1]="DOCX"}(t.WORDSuffixEnum||(t.WORDSuffixEnum={})),function(e){e[e.PPT=0]="PPT",e[e.PPTX=1]="PPTX"}(t.PPTSuffixEnum||(t.PPTSuffixEnum={})),function(e){e[e.FileTypeUnknown=0]="FileTypeUnknown",e[e.FileTypePPT=1]="FileTypePPT",e[e.FileTypeDOC=2]="FileTypeDOC",e[e.FileTypeELS=4]="FileTypeELS",e[e.FileTypePDF=8]="FileTypePDF",e[e.FileTypeIMG=16]="FileTypeIMG",e[e.FileTypeTXT=32]="FileTypeTXT"}(t.FileTypeEnum||(t.FileTypeEnum={})),function(e){e[e.FileTypePPT=1]="FileTypePPT",e[e.FileTypeDOC=2]="FileTypeDOC",e[e.FileTypeELS=4]="FileTypeELS",e[e.FileTypePDF=8]="FileTypePDF",e[e.FileTypeIMG=16]="FileTypeIMG",e[e.FileTypeTXT=32]="FileTypeTXT",e[e.FileTypeH5=64]="FileTypeH5",e[e.FileTypeH5PDF=128]="FileTypeH5PDF",e[e.FileTypeIMGAndPDF=256]="FileTypeIMGAndPDF",e[e.FileTypeDynamicPPTH5=512]="FileTypeDynamicPPTH5"}(t.ExpectFileTypeEnum||(t.ExpectFileTypeEnum={})),function(e){e[e.RenderTypeVector=1]="RenderTypeVector",e[e.RenderTypeIMG=2]="RenderTypeIMG",e[e.RenderTypeVectorAndIMG=3]="RenderTypeVectorAndIMG",e[e.RenderTypeDynamicPPTH5=6]="RenderTypeDynamicPPTH5"}(t.RenderTypeEnum||(t.RenderTypeEnum={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCodeMap=t.ErrorCodeData=void 0,t.ErrorCodeData={4:"参数错误",32:"文档转换失败",64:"转换任务已取消",128:"文档已加密",256:"文档内容过大",512:"Excel文件标签数过多",30001:"请求过于频繁",60002:"文件不存在",60011:"token无效",60012:"token已过期",60013:"文档转换请求已处理",60014:"不存在的任务ID",60015:"不支持的文件类型",2000002:"参数错误",2010003:"不支持渲染模式",2030008:"空域名"},t.ErrorCodeMap={4:2000002,32:2020004,64:2020005,128:2020001,256:2020002,512:2020003,30001:30001,60002:60002,60011:60011,60012:60012,60013:60013,60014:60014,60015:60015,2000002:2000002,2010003:2010003,2030008:2030008}},function(e,t,r){var n,i,o;e.exports=(o=r(1),i=(n=o).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var i=[],o=0;o<r;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<r;s++)i.push(n.charAt(a>>>6*(3-s)&63));var c=n.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var o=0;o<r.length;o++)n[r.charCodeAt(o)]=o}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,r){for(var n=[],o=0,a=0;a<t;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,c=r[e.charCodeAt(a)]>>>6-a%4*2;n[o>>>2]|=(s|c)<<24-o%4*8,o++}return i.create(n,o)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)},function(e,t,r){var n;e.exports=(n=r(1),function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,i=e[n];e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,a=e[t+0],c=e[t+1],d=e[t+2],h=e[t+3],g=e[t+4],v=e[t+5],y=e[t+6],m=e[t+7],w=e[t+8],_=e[t+9],P=e[t+10],I=e[t+11],b=e[t+12],T=e[t+13],D=e[t+14],E=e[t+15],x=o[0],C=o[1],S=o[2],F=o[3];x=u(x,C,S,F,a,7,s[0]),F=u(F,x,C,S,c,12,s[1]),S=u(S,F,x,C,d,17,s[2]),C=u(C,S,F,x,h,22,s[3]),x=u(x,C,S,F,g,7,s[4]),F=u(F,x,C,S,v,12,s[5]),S=u(S,F,x,C,y,17,s[6]),C=u(C,S,F,x,m,22,s[7]),x=u(x,C,S,F,w,7,s[8]),F=u(F,x,C,S,_,12,s[9]),S=u(S,F,x,C,P,17,s[10]),C=u(C,S,F,x,I,22,s[11]),x=u(x,C,S,F,b,7,s[12]),F=u(F,x,C,S,T,12,s[13]),S=u(S,F,x,C,D,17,s[14]),x=f(x,C=u(C,S,F,x,E,22,s[15]),S,F,c,5,s[16]),F=f(F,x,C,S,y,9,s[17]),S=f(S,F,x,C,I,14,s[18]),C=f(C,S,F,x,a,20,s[19]),x=f(x,C,S,F,v,5,s[20]),F=f(F,x,C,S,P,9,s[21]),S=f(S,F,x,C,E,14,s[22]),C=f(C,S,F,x,g,20,s[23]),x=f(x,C,S,F,_,5,s[24]),F=f(F,x,C,S,D,9,s[25]),S=f(S,F,x,C,h,14,s[26]),C=f(C,S,F,x,w,20,s[27]),x=f(x,C,S,F,T,5,s[28]),F=f(F,x,C,S,d,9,s[29]),S=f(S,F,x,C,m,14,s[30]),x=l(x,C=f(C,S,F,x,b,20,s[31]),S,F,v,4,s[32]),F=l(F,x,C,S,w,11,s[33]),S=l(S,F,x,C,I,16,s[34]),C=l(C,S,F,x,D,23,s[35]),x=l(x,C,S,F,c,4,s[36]),F=l(F,x,C,S,g,11,s[37]),S=l(S,F,x,C,m,16,s[38]),C=l(C,S,F,x,P,23,s[39]),x=l(x,C,S,F,T,4,s[40]),F=l(F,x,C,S,a,11,s[41]),S=l(S,F,x,C,h,16,s[42]),C=l(C,S,F,x,y,23,s[43]),x=l(x,C,S,F,_,4,s[44]),F=l(F,x,C,S,b,11,s[45]),S=l(S,F,x,C,E,16,s[46]),x=p(x,C=l(C,S,F,x,d,23,s[47]),S,F,a,6,s[48]),F=p(F,x,C,S,m,10,s[49]),S=p(S,F,x,C,D,15,s[50]),C=p(C,S,F,x,v,21,s[51]),x=p(x,C,S,F,b,6,s[52]),F=p(F,x,C,S,h,10,s[53]),S=p(S,F,x,C,P,15,s[54]),C=p(C,S,F,x,c,21,s[55]),x=p(x,C,S,F,w,6,s[56]),F=p(F,x,C,S,E,10,s[57]),S=p(S,F,x,C,y,15,s[58]),C=p(C,S,F,x,T,21,s[59]),x=p(x,C,S,F,g,6,s[60]),F=p(F,x,C,S,I,10,s[61]),S=p(S,F,x,C,d,15,s[62]),C=p(C,S,F,x,_,21,s[63]),o[0]=o[0]+x|0,o[1]=o[1]+C|0,o[2]=o[2]+S|0,o[3]=o[3]+F|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;r[i>>>5]|=128<<24-i%32;var o=e.floor(n/4294967296),a=n;r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var f=c[u];c[u]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return s},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,i,o,a){var s=e+(t&r|~t&n)+i+a;return(s<<o|s>>>32-o)+t}function f(e,t,r,n,i,o,a){var s=e+(t&n|r&~n)+i+a;return(s<<o|s>>>32-o)+t}function l(e,t,r,n,i,o,a){var s=e+(t^r^n)+i+a;return(s<<o|s>>>32-o)+t}function p(e,t,r,n,i,o,a){var s=e+(r^(t|~n))+i+a;return(s<<o|s>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),n.MD5)},function(e,t,r){var n,i,o,a,s,c,u,f;e.exports=(f=r(1),r(8),r(9),i=(n=f).lib,o=i.Base,a=i.WordArray,s=n.algo,c=s.MD5,u=s.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),i=a.create(),o=i.words,s=r.keySize,c=r.iterations;o.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var f=1;f<c;f++)u=n.finalize(u),n.reset();i.concat(u)}return i.sigBytes=4*s,i}}),n.EvpKDF=function(e,t,r){return u.create(r).compute(e,t)},f.EvpKDF)},function(e,t,r){var n,i,o,a,s,c,u,f;e.exports=(f=r(1),i=(n=f).lib,o=i.WordArray,a=i.Hasher,s=n.algo,c=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var f=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=f<<1|f>>>31}var l=(n<<5|n>>>27)+s+c[u];l+=u<20?1518500249+(i&o|~i&a):u<40?1859775393+(i^o^a):u<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,s=a,a=o,o=i<<30|i>>>2,i=n,n=l}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),f.SHA1)},function(e,t,r){var n,i,o,a;e.exports=(n=r(1),o=(i=n).lib.Base,a=i.enc.Utf8,void(i.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),s=i.words,c=o.words,u=0;u<r;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},function(e,t,r){var n;e.exports=(n=r(1),r(7),void(n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,o=r.WordArray,a=r.BufferedBlockAlgorithm,s=t.enc,c=(s.Utf8,s.Base64),u=t.algo.EvpKDF,f=r.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(r,n,i){return e(n).encrypt(t,r,n,i)},decrypt:function(r,n,i){return e(n).decrypt(t,r,n,i)}}}}()}),l=(r.StreamCipher=f.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),p=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),d=l.CBC=function(){var e=p.extend();function t(e,t,r){var n=this._iv;if(n){var i=n;this._iv=void 0}else i=this._prevBlock;for(var o=0;o<r;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize;t.call(this,e,r,i),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+i)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,i=n.blockSize,o=e.slice(r,r+i);n.decryptBlock(e,r),t.call(this,e,r,i),this._prevBlock=o}}),e}(),h=(t.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,i=n<<24|n<<16|n<<8|n,a=[],s=0;s<n;s+=4)a.push(i);var c=o.create(a,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(r.BlockCipher=f.extend({cfg:f.cfg.extend({mode:d,padding:h}),reset:function(){f.reset.call(this);var e=this.cfg,t=e.iv,r=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=r.createEncryptor;else n=r.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(r,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;if(r)var n=o.create([1398893684,1701076831]).concat(r).concat(t);else n=t;return n.toString(c)},parse:function(e){var t=c.parse(e),r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=o.create(r.slice(2,4));r.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:n})}},y=r.SerializableCipher=i.extend({cfg:i.extend({format:v}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n),o=i.finalize(t),a=i.cfg;return g.create({ciphertext:o,key:r,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),m=(t.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=o.random(8));var i=u.create({keySize:t+r}).compute(e,n),a=o.create(i.words.slice(t),4*r);return i.sigBytes=4*t,g.create({key:i,iv:a,salt:n})}},w=r.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:m}),encrypt:function(e,t,r,n){var i=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=i.iv;var o=y.encrypt.call(this,e,t,i.key,n);return o.mixIn(i),o},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var i=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=i.iv,y.decrypt.call(this,e,t,i.key,n)}})}()))},function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";var n=r(0);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,r){"use strict";(function(t){var n=r(0),i=r(41),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=r(15)),s),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){c.headers[e]=n.merge(o)})),e.exports=c}).call(this,r(40))},function(e,t,r){"use strict";var n=r(0),i=r(42),o=r(12),a=r(44),s=r(47),c=r(48),u=r(16);e.exports=function(e){return new Promise((function(t,f){var l=e.data,p=e.headers;n.isFormData(l)&&delete p["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",g=e.auth.password||"";p.Authorization="Basic "+btoa(h+":"+g)}var v=a(e.baseURL,e.url);if(d.open(e.method.toUpperCase(),o(v,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?s(d.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:e,request:d};i(t,f,n),d=null}},d.onabort=function(){d&&(f(u("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){f(u("Network Error",e,null,d)),d=null},d.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),f(u(t,e,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var y=r(49),m=(e.withCredentials||c(v))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;m&&(p[e.xsrfHeaderName]=m)}if("setRequestHeader"in d&&n.forEach(p,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),f(e),d=null)})),void 0===l&&(l=null),d.send(l)}))}},function(e,t,r){"use strict";var n=r(43);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t){t=t||{};var r={},i=["url","method","params","data"],o=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];n.forEach(i,(function(e){void 0!==t[e]&&(r[e]=t[e])})),n.forEach(o,(function(i){n.isObject(t[i])?r[i]=n.deepMerge(e[i],t[i]):void 0!==t[i]?r[i]=t[i]:n.isObject(e[i])?r[i]=n.deepMerge(e[i]):void 0!==e[i]&&(r[i]=e[i])})),n.forEach(a,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])}));var s=i.concat(o).concat(a),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return n.forEach(c,(function(n){void 0!==t[n]?r[n]=t[n]:void 0!==e[n]&&(r[n]=e[n])})),r}},function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transError=t.RenderMode=t.FileType=void 0,function(e){e[e.PPT=1]="PPT",e[e.DOC=2]="DOC",e[e.ELS=4]="ELS",e[e.PDF=8]="PDF",e[e.IMG=16]="IMG",e[e.TXT=32]="TXT",e[e.PPTH5=512]="PPTH5"}(t.FileType||(t.FileType={})),function(e){e[e.PDF=0]="PDF",e[e.PPT=1]="PPT",e[e.PPTH5=2]="PPTH5"}(t.RenderMode||(t.RenderMode={}));var n={0:0,32:2020004,64:2020005,128:2020001,512:2020003,"-102":2000003,"-105":2010001,"-109":2010002,"-110":2030002,"-115":2030005,"-116":2030003,"-117":2020002,"-118":2030006,"-119":2030007,"-120":2010003,"-999998":2030004,"-999999":2000002};t.transError=function(e){return n[e]||e}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressDocs=void 0,r(23);var n=r(24),i=r(52),o=r(54),a=function(){function e(e){this.docsviews={};var t={appID:e.appID,userID:e.userID,token:e.token,isTestEnv:!!e.isTestEnv};this.serviceHandle=new o.ZegoDocsViewService(new n.ZegoDocs(t))}return e.prototype.createView=function(e,t,r){t=(t||Date.now()+Math.floor(1e3*Math.random()))+"",r=r||"";var n=this.docsviews[t];if(n)return n.setSheetName(r),n;var o=document.getElementById("zego-whiteboard"+t);return(o=o&&o.parentElement)&&(n=this.docsviews[o.id.replace("zego-docsview","")])?(n.setSheetName(r),this.docsviews[t]=n,n):(n=new i.ZegoDocsViewMod(this.serviceHandle,e,t,r),this.docsviews[t]=n,n)},e.prototype.uploadFile=function(e,t){return this.serviceHandle.upload({file:e,renderType:t})},e.prototype.on=function(e,t){return this.serviceHandle.addEventListener(e,t)},e.prototype.off=function(e,t){return this.serviceHandle.removeEventListener(e,t)},e.prototype.setTestEnv=function(e){this.serviceHandle.setTestEnv(e)},e.prototype.setConfig=function(e,t){return this.serviceHandle.setConfig(e,t)},e.prototype.getConfig=function(e){return this.serviceHandle.getConfig(e)},e}();t.ZegoExpressDocs=a},function(e,t){!function(){if(-1!==window.navigator.userAgent.indexOf("Trident")){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}e.prototype=window.Event.prototype,window.CustomEvent=e,document.body.scrollTo||(Element.prototype.scrollTo=function(e,t){this.scrollLeft=e,this.scrollTop=t}),document.body.scrollBy||(Element.prototype.scrollBy=function(e,t){this.scrollLeft+=e,this.scrollTop+=t}),FileReader.prototype.readAsBinaryString||(FileReader.prototype.readAsBinaryString=function(e){var t=this,r=new FileReader;r.onload=function(e){for(var n="",i=new Uint8Array(r.result),o=i.byteLength,a=0;a<o;a++)n+=String.fromCharCode(i[a]);t.content=n,t.result=n,t.onload()},r.readAsArrayBuffer(e)})}}()},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocs=void 0;var s=r(3),c=r(25),u=r(4),f=r(33),l=a(r(34)),p=function(){function e(e){this.axiosInstance=l.default.create({timeout:1e4}),this.stateCenter={appID:0,platform:32,webToken:"",userID:""},this.init(e)}return e.prototype.init=function(e){var t=e.token,r=e.appID,n=e.userID,i=e.isTestEnv;this.stateCenter.appID=r,this.stateCenter.webToken=t,this.stateCenter.userID=n,this.config={testDomain:"https://docservice-test.zego.im",domain:c.isPrivateServer?"":"https://docservice"+r+".zego.im",testEnv:!1},this.setTestEnv(!!i)},e.prototype.setTestEnv=function(e){var t=e?this.config.testDomain:this.config.domain;this.config.testEnv=!!e,this.requestUrls={queryStatusUrl:t+"/doc/query_status",createCvtUrl:t+"/doc/cvt_doc",cancelCvtUrl:t+"/doc/cancel_cvt",queryUrl:t+"/doc/access"}},e.prototype.setConfig=function(e,t){return!(!e||!t&&0!==t)&&(this.config[e]=t,!0)},e.prototype.getConfig=function(e){return this.config[e]},e.prototype.upload=function(e){return this.config.testEnv||this.config.domain||!c.isPrivateServer?e.file&&e.renderType?this.uploadProgress(e):Promise.reject({code:c.codeMapHandle(2000002),message:u.ErrorCodeData[2000002]}):Promise.reject({code:c.codeMapHandle(2030008),message:u.ErrorCodeData[2030008]})},e.prototype.load=function(e){var t=this;if(!this.config.testEnv&&!this.config.domain&&c.isPrivateServer)return Promise.reject({code:c.codeMapHandle(2030008),message:u.ErrorCodeData[2030008]});if(!e.fileID)return Promise.reject({code:c.codeMapHandle(2000002),message:u.ErrorCodeData[2000002]});var r={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_id:e.fileID};return new Promise((function(n,a){return i(t,void 0,void 0,(function(){var t,i,s,f,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryUrl,method:"post",timeout:e.timeout||1e4,data:r})];case 1:return t=o.sent(),i=t.data,0===i.ret.code?(i.file_urls=i.file_urls||[],s={pageCount:i.page_count||i.file_urls.length||1,notes:i.note||[""],fileUrls:i.file_urls,fileSize:i.file_size,fileHash:i.file_hash},c.handleFileOfView(r.file_id,i,s),16===i.file_type?this.decryptImages(i.file_urls).then((function(e){s.fileUrls=e,n(s)})).catch((function(e){return a(e)})):n(s)):(f={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},a(f)),[3,3];case 2:return l=o.sent(),a(l),[3,3];case 3:return[2]}}))}))}))},e.prototype.cancelUpload=function(e){var t=this,r=e.timeout,n=e.taskID,a={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,task_id:n};return new Promise((function(e,s){return i(t,void 0,void 0,(function(){var t,i,f,l;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.cancelCvtUrl,method:"post",timeout:r||1e4,data:a})];case 1:return t=o.sent(),0===(i=t.data).ret.code?e({taskID:n}):(f={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},s(f)),[3,3];case 2:return l=o.sent(),s(l),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadSucceedAfter=function(e){var t=e.uploadResult,r=e.onProgress,n=e.originReslove,i=e.resolve;r&&r(t),n?n(t):i(t)},e.prototype.uploadProgressInit=function(e){return i(this,void 0,void 0,(function(){var t,r,n,i,a,c,u,f;return o(this,(function(o){switch(o.label){case 0:return t=e.statusInitSub,r=e.file,n=e.onProgress,a=(i=t).oss,c=i.fileServerProvider,u=i.fileHash,f=i.sfs,n&&n({status:s.UploadStatus.UPLOADING,fileHash:u}),[4,this.uploadDoc({file:r,fileServerProvider:c,oss:a,sfs:f,fileHash:u,onProgress:n})];case 1:return o.sent(),n&&n({status:s.UploadStatus.UPLOADED,fileHash:u}),[4,this.uploadProgressCvt(e)];case 2:return o.sent(),[2,!0]}}))}))},e.prototype.uploadProgressCvt=function(e){return i(this,void 0,void 0,(function(){var t,r,n,i,a,s,u,f,l,p,d,h,g;return o(this,(function(o){switch(o.label){case 0:return t=e.file,r=e.onProgress,n=e.fileType,i=e.fileHash,a=e.originReslove,s=e.resolve,u=e.expectFileType,f=e.originReject,l=e.reject,d=this.createCvtDoc,h={},[4,c.getFileSize(t)];case 1:return[4,d.apply(this,[(h.fileSize=o.sent().fileSize,h.fileName=c.getFileName(t),h.fileType=n,h.fileHash=i,h.expectFileType=u,h)])];case 2:return p=o.sent(),g={taskID:p.taskID,onProgress:r},[4,this.uploadProgress(g,a||s,f||l)];case 3:return o.sent(),[2,!0]}}))}))},e.prototype.uploadProgress=function(e,t,r){var n=this;return new Promise((function(a,f){return i(n,void 0,void 0,(function(){var n,l,p,d,h,g,v,y,m,w,_=this;return o(this,(function(P){switch(P.label){case 0:return P.trys.push([0,6,,7]),l=(n=e).file,p=n.renderType,d=void 0,h=s.FileTypeEnum.FileTypeUnknown,g=void 0,v=s.ExpectFileTypeEnum.FileTypePDF,l?(h=c.getFileType(l),s.RenderTypeEnum[p]?(v=c.getExpectFileType(p,h),[4,c.getMd5(l)]):(f({code:c.codeMapHandle(2010003),message:u.ErrorCodeData[2010003]}),[2])):[3,3];case 1:return d=P.sent().fileHash,0===h?(f({code:c.codeMapHandle(60015),message:u.ErrorCodeData[60015]}),[2]):[4,this.queryStatus({fileHash:d,fileType:h,expectFileType:v})];case 2:return g=P.sent(),[3,5];case 3:return[4,this.queryStatus({taskID:e.taskID})];case 4:g=P.sent(),P.label=5;case 5:switch(y=g.status){case s.UploadStatus.UPLOADING:this.uploadProgressInit({file:l,expectFileType:v,fileType:h,fileHash:d,statusInitSub:g,onProgress:e.onProgress,originReslove:t,resolve:a,originReject:r,reject:f});break;case s.UploadStatus.UPLOADED:this.uploadProgressCvt({file:l,expectFileType:v,fileType:h,fileHash:d,onProgress:e.onProgress,originReslove:t,resolve:a,originReject:r,reject:f});break;case s.UploadStatus.WAITING:case s.UploadStatus.CONVERTING:m=g.taskID,e.onProgress&&e.onProgress({status:y,taskID:m}),setTimeout((function(){return i(_,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this.uploadProgress({taskID:m,onProgress:e.onProgress},t||a,r||f)];case 1:return n.sent(),[2]}}))}))}),2e3);break;case s.UploadStatus.CONVERTED:this.uploadSucceedAfter({uploadResult:{fileID:g.fileID,status:g.status},onProgress:e.onProgress,originReslove:t,resolve:a});break;default:r?r({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]}):f({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]})}return[3,7];case 6:return w=P.sent(),r?r(w):f(w),[3,7];case 7:return[2]}}))}))}))},e.prototype.requestHandle=function(e){var t=this;return"wx"===c.getEnv()?new Promise((function(r,a){return i(t,void 0,void 0,(function(){return o(this,(function(t){return wx.request(n(n({},e),{success:function(e){r(e)},fail:function(e){a(e)}})),[2]}))}))})):this.axiosInstance(e)},e.prototype.queryStatus=function(e){var t=this,r={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID};if(e.taskID)r.task_id=e.taskID;else{var n=e,a=n.fileHash,s=n.fileType,f=n.expectFileType;r.file_hash=a,r.file_type=s,r.expect_file_type=f}return new Promise((function(n,a){return i(t,void 0,void 0,(function(){var t,i,s,f,l,p,d,h,g,v,y,m,w,_;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryStatusUrl,method:"post",timeout:e.timeout||1e4,data:r})];case 1:if(t=o.sent(),i=t.data,s=i.ret,f=i.file_type,l=i.status,p=i.file_hash,d=i.file_server_provider,h=i.oss,g=i.sfs,v=i.task_id,y=i.query_interval,m=i.file_id,0===s.code)switch(l){case 32:case 64:case 128:case 256:case 512:a({code:c.codeMapHandle(l),message:u.ErrorCodeData[l]});break;case 1:n({fileType:f,status:l,fileHash:p,fileServerProvider:d,oss:h,sfs:g});break;case 2:n({fileType:f,status:l,fileHash:p});break;case 4:n({fileType:f,status:l,taskID:v,queryInterval:y||1e3});break;case 8:n({fileType:f,status:l,taskID:v});break;case 16:n({fileID:m,status:l});break;default:a({code:c.codeMapHandle(32),message:u.ErrorCodeData[32]})}else w={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},a(w);return[3,3];case 2:return _=o.sent(),a(_),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadDocToOssByWx=function(e){var t=e.oss,r=e.file,n=e.onProgress,i=c.getUploadOssInfo(t);return new Promise((function(e,t){try{wx.uploadFile({url:i.url,filePath:r,name:"file",formData:{key:i.objectName,policy:i.policy,OSSAccessKeyId:i.OSSAccessKeyId,success_action_status:i.successActionStatus,signature:i.signature,"x-oss-security-token":i.securityToken},timeout:6e5,success:function(t){e()},fail:function(e){t(e)}}).onProgressUpdate((function(e){var t=e.progress,r=e.totalBytesSent,i=e.totalBytesExpectedToSend;n&&n({status:s.UploadStatus.UPLOADING,uploadPercent:t,loaded:r,total:i})}))}catch(e){t(e)}}))},e.prototype.uploadDocToOssByWeb=function(e){var t=e.oss,r=e.file,n=e.onProgress,i=c.getUploadOssInfo(t),o=new FormData;return o.append("OSSAccessKeyId",i.OSSAccessKeyId),o.append("x-oss-security-token",i.securityToken),o.append("signature",i.signature),o.append("policy",i.policy),o.append("successActionStatus",i.successActionStatus),o.append("key",i.objectName),o.append("file",r),o.append("name",r.name),this.axiosInstance({method:"post",url:i.url,data:o,timeout:6e5,onUploadProgress:function(e){var t=e.total,r=e.loaded;n&&n({status:s.UploadStatus.UPLOADING,uploadPercent:Math.floor(r/t*100),total:t,loaded:r})}})},e.prototype.uploadDoc=function(e){var t=e.fileServerProvider;if("oss"===t)return"wx"===c.getEnv()?this.uploadDocToOssByWx(e):this.uploadDocToOssByWeb(e);if("sfs"===t)return"wx"===c.getEnv()?f.uploadDocToSfsByWx(this,e):f.uploadDocToSfsByWeb(this,e);var r={code:c.codeMapHandle(4),message:"参数错误"};return Promise.reject(r)},e.prototype.createCvtDoc=function(e){var t=this,r=e.timeout,n=e.srcFileUrl,a=e.fileName,s=e.fileHash,f=e.fileSize,l=e.fileType,p=e.expectFileType,d={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_name:a,file_hash:s,file_size:f,file_type:l,expect_file_type:p};return n&&(d.src_file_url=n),new Promise((function(e,n){return i(t,void 0,void 0,(function(){var t,i,a,s;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.createCvtUrl,method:"post",timeout:r||1e4,data:d})];case 1:return t=o.sent(),i=t.data,0===i.ret.code?e({status:i.status,taskID:i.task_id}):(a={code:c.codeMapHandle(i.ret.code),message:u.ErrorCodeData[i.ret.code]||i.ret.message},n(a)),[3,3];case 2:return s=o.sent(),n(s),[3,3];case 3:return[2]}}))}))}))},e.prototype.decryptImages=function(e){var t=this,r=e.map((function(e){return t.requestHandle({url:e,method:"get",timeout:1e4,responseType:"arraybuffer"}).then((function(e){var t=new Uint8Array(e.data),r=c.decryptU8arry(t.slice(0,1024));if("wx"===c.getEnv()){for(var n=[],i=r.byteLength,o=0;o<i;o++)n[o]=r[o];var a=t.slice(1024);for(o=0;o<a.byteLength;o++)n[o+i]=a[o];return"data:image/png;base64,"+wx.arrayBufferToBase64(n)}return URL.createObjectURL(new Blob([r,t.slice(1024)],{type:"image/png"}))}))}));return Promise.all(r)},e}();t.ZegoDocs=p},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleFileOfView=t.codeMapHandle=t.decryptU8arry=t.refreshCDNHandle=t.getUploadOssInfo=t.getExpectFileType=t.getFileName=t.getFileSize=t.getFileType=t.getMd5=t.getEnv=t.isPrivateServer=void 0;var i=r(4),o=r(3),a=n(r(26)),s=n(r(28)),c=n(r(6)),u=n(r(29)),f=n(r(30)),l=n(r(31)),p=n(r(5)),d=n(r(32)),h=n(r(1)),g=l.default.parse("89c78c018ed563571a3024342073c002"),v=l.default.parse("0d9d89c53bd0a086834b411fe8387946");t.isPrivateServer=!1;var y="";t.getEnv=function(){return y||(y="undefined"!=typeof wx&&"function"==typeof wx.canIUse?"wx":"web"),y},t.getMd5=function(e){return new Promise((function(t,r){try{if("string"==typeof e)wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var r=e.digest;t({fileHash:r})},fail:function(e){r(e)}});else{var n=new FileReader;n.onload=function(){var e=n.result||n.content;t({fileHash:c.default(f.default.parse(e)).toString(l.default)})},n.readAsBinaryString(e)}}catch(e){r(e)}}))},t.getFileType=function(e){var t,r=("string"==typeof e?e:e.name).split(".").pop();switch(r?r.toUpperCase():r){case"XLSX":case"XLS":t=4;break;case"DOC":case"DOCX":t=2;break;case"PPT":case"PPTX":t=1;break;case"TXT":case"MD":case"C":case"CPP":case"H":case"HPP":case"PY":case"JS":case"XML":t=32;break;case"PDF":t=8;break;case"PNG":case"JPEG":case"JPG":case"BMP":t=16;break;default:t=0}return t},t.getFileSize=function(e){return new Promise((function(t,r){try{"string"==typeof e?wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var r=e.size;t({fileSize:r})},fail:function(e){r(e)}}):t({fileSize:e.size})}catch(e){r(e)}}))},t.getFileName=function(e){return"string"==typeof e?e.split("wxfile://")[1]||e.split("http://")[1]||e.split("https://")[1]:e.name},t.getExpectFileType=function(e,t){var r;switch(e){case o.RenderTypeEnum.RenderTypeVector:r=o.ExpectFileTypeEnum.FileTypePDF;break;case o.RenderTypeEnum.RenderTypeIMG:r=o.ExpectFileTypeEnum.FileTypeIMG;break;case o.RenderTypeEnum.RenderTypeVectorAndIMG:r=t===o.FileTypeEnum.FileTypeIMG?o.ExpectFileTypeEnum.FileTypeIMG:o.ExpectFileTypeEnum.FileTypeIMGAndPDF;break;case o.RenderTypeEnum.RenderTypeDynamicPPTH5:r=o.ExpectFileTypeEnum.FileTypeDynamicPPTH5;break;default:r=o.ExpectFileTypeEnum.FileTypeIMGAndPDF}return r};var m=function(e,t){return p.default.stringify(u.default(t,e))};t.getUploadOssInfo=function(e){var t=e.access_key_id,r=e.access_key_secret,n=e.bucket_name,i=e.security_token,o=e.endpoint,s=e.object_name,c=e.timeout,u=void 0===c?1:c,f=e.maxSize,l=function(e,t){var r=new Date;r.setHours(r.getHours()+e);var n={expiration:r.toISOString(),conditions:[["content-length-range",0,1024*t*1024]]};return a.default.Base64.encode(JSON.stringify(n))}(u,void 0===f?150:f);return{url:"https://"+n+"."+o,signature:m(r,l),securityToken:i,policy:l,key:s,OSSAccessKeyId:t,successActionStatus:"200",objectName:s}},t.refreshCDNHandle=function(e){};t.decryptU8arry=function(e){var t=function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e[n])<<24-n%4*8;return h.default.lib.WordArray.create(r,t)}(e).toString(p.default);return function(e){for(var t=e.words,r=e.sigBytes,n=new Uint8Array(r),i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n[i]=o}return n}(s.default.decrypt(t,g,{iv:v,mode:h.default.mode.CBC,padding:d.default}))},t.codeMapHandle=function(e){return i.ErrorCodeMap[e]||e},t.handleFileOfView=function(e,t,r){if(Object.assign(r,{fileID:e,fileName:t.file_name,fileType:t.expect_file_type===o.ExpectFileTypeEnum.FileTypeDynamicPPTH5?o.ExpectFileTypeEnum.FileTypeDynamicPPTH5:t.file_type,width:t.width,height:t.height}),t.file_type===o.ExpectFileTypeEnum.FileTypeELS&&t.split_file_list){var n=[];r.file_list=t.split_file_list.map((function(e){var r=0|e.width,i=0|e.height;return{name:t.file_name,file_name:e.file_name,page_list:e.file_urls.map((function(e,t){return n.push(e),{width:r,height:i,src:e,virtual_page_list:[{width:r,height:i,virtual_page_number:t+1}]}}))}})),r.fileUrls=n,r.pageCount=n.length}}},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,(function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.2",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(r>>>18),b64chars.charAt(r>>>12&63),t>=2?"=":b64chars.charAt(r>>>6&63),t>=1?"=":b64chars.charAt(63&r)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)?e.toString("base64"):btoa(utob(String(e)))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):_encode(e)},encodeURI=function(e){return encode(e,!0)},re_btou=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,r=t%4,n=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),i=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return i.length-=[0,0,2,1][r],i.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum((function(){return decode(this)}))),Object.defineProperty(String.prototype,"toBase64",noEnum((function(e){return encode(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",noEnum((function(){return encode(this,!0)})))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}))}).call(this,__webpack_require__(27))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n;e.exports=(n=r(1),r(5),r(6),r(7),r(10),function(){var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],o=[],a=[],s=[],c=[],u=[],f=[],l=[],p=[],d=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var h=n^n<<1^n<<2^n<<3^n<<4;h=h>>>8^255&h^99,i[r]=h,o[h]=r;var g=e[r],v=e[g],y=e[v],m=257*e[h]^16843008*h;a[r]=m<<24|m>>>8,s[r]=m<<16|m>>>16,c[r]=m<<8|m>>>24,u[r]=m,m=16843009*y^65537*v^257*g^16843008*r,f[h]=m<<24|m>>>8,l[h]=m<<16|m>>>16,p[h]=m<<8|m>>>24,d[h]=m,r?(r=g^e[e[e[y^g]]],n^=e[e[n]]):r=n=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),o=this._keySchedule=[],a=0;a<n;a++)if(a<r)o[a]=t[a];else{var s=o[a-1];a%r?r>6&&a%r==4&&(s=i[s>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s]):(s=i[(s=s<<8|s>>>24)>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s],s^=h[a/r|0]<<24),o[a]=o[a-r]^s}for(var c=this._invKeySchedule=[],u=0;u<n;u++)a=n-u,s=u%4?o[a]:o[a-4],c[u]=u<4||a<=4?s:f[i[s>>>24]]^l[i[s>>>16&255]]^p[i[s>>>8&255]]^d[i[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,i)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,f,l,p,d,o),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,a,s){for(var c=this._nRounds,u=e[t]^r[0],f=e[t+1]^r[1],l=e[t+2]^r[2],p=e[t+3]^r[3],d=4,h=1;h<c;h++){var g=n[u>>>24]^i[f>>>16&255]^o[l>>>8&255]^a[255&p]^r[d++],v=n[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^a[255&u]^r[d++],y=n[l>>>24]^i[p>>>16&255]^o[u>>>8&255]^a[255&f]^r[d++],m=n[p>>>24]^i[u>>>16&255]^o[f>>>8&255]^a[255&l]^r[d++];u=g,f=v,l=y,p=m}g=(s[u>>>24]<<24|s[f>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^r[d++],v=(s[f>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^r[d++],y=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&f])^r[d++],m=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[f>>>8&255]<<8|s[255&l])^r[d++],e[t]=g,e[t+1]=v,e[t+2]=y,e[t+3]=m},keySize:8});e.AES=t._createHelper(g)}(),n.AES)},function(e,t,r){var n;e.exports=(n=r(1),r(8),r(9),n.HmacSHA1)},function(e,t,r){var n;e.exports=(n=r(1),n.enc.Latin1)},function(e,t,r){var n;e.exports=(n=r(1),n.enc.Hex)},function(e,t,r){var n;e.exports=(n=r(1),r(10),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDocToSfsByWeb=t.uploadDocToSfsByWx=void 0;var n=r(3);t.uploadDocToSfsByWx=function(e,t){var r=t.sfs,i=t.fileHash,o=t.file,a=t.onProgress,s=r,c=s.token,u=s.expired_timestamp,f=s.api,l=s.object_name,p={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:u,sfs_token:c,file_name:l,file_hash:i},d=new FormData;return d.append("req",new Blob([JSON.stringify(p)],{type:"application/json"})),d.append("document",o),new Promise((function(e,t){try{wx.uploadFile({url:f,filePath:o,name:"file",formData:d,timeout:6e5,success:function(t){e()},fail:function(e){t(e)}}).onProgressUpdate((function(e){var t=e.progress,r=e.totalBytesSent,i=e.totalBytesExpectedToSend;a&&a({status:n.UploadStatus.UPLOADING,uploadPercent:t,loaded:r,total:i})}))}catch(e){t(e)}}))},t.uploadDocToSfsByWeb=function(e,t){var r=t.sfs,i=t.fileHash,o=t.file,a=t.onProgress,s=r,c=s.token,u=s.expired_timestamp,f=s.api,l=s.object_name,p={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:u,sfs_token:c,file_name:l,file_hash:i},d=new FormData;return d.append("req",new Blob([JSON.stringify(p)],{type:"application/json"})),d.append("document",o),e.axiosInstance({method:"post",url:f,data:d,timeout:6e5,onUploadProgress:function(e){var t=e.total,r=e.loaded;a&&a({status:n.UploadStatus.UPLOADING,uploadPercent:Math.floor(r/t*100),total:t,loaded:r})}})}},function(e,t,r){e.exports=r(35)},function(e,t,r){"use strict";var n=r(0),i=r(11),o=r(36),a=r(17);function s(e){var t=new o(e),r=i(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var c=s(r(14));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=r(18),c.CancelToken=r(50),c.isCancel=r(13),c.all=function(e){return Promise.all(e)},c.spread=r(51),e.exports=c,e.exports.default=c},function(e,t,r){"use strict";var n=r(0),i=r(12),o=r(37),a=r(38),s=r(17);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,r){return this.request(n.merge(r||{},{method:e,url:t}))}})),n.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,r,i){return this.request(n.merge(i||{},{method:e,url:t,data:r}))}})),e.exports=c},function(e,t,r){"use strict";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,r){"use strict";var n=r(0),i=r(39),o=r(13),a=r(14);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],f=!1,l=-1;function p(){f&&c&&(f=!1,c.length?u=c.concat(u):l=-1,u.length&&d())}function d(){if(!f){var e=s(p);f=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||f||s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=r(0);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},function(e,t,r){"use strict";var n=r(16);e.exports=function(e,t,r){var i=r.config.validateStatus;!i||i(r.status)?e(r):t(n("Request failed with status code "+r.status,r.config,null,r.request,r))}},function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,r){"use strict";var n=r(45),i=r(46);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,r){"use strict";var n=r(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},function(e,t,r){"use strict";var n=r(0);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},function(e,t,r){"use strict";var n=r(0);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,r){"use strict";var n=r(18);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewMod=void 0;var o=r(19),a=function(e){function t(t,r,n,i){var a=e.call(this)||this;return a.parent="",a.id="",a.drawMode=o.RenderMode.PDF,a.viewInfo={ticking:!1,percent:0,page:1,total:1,sheet:0,sheetName:"",parentWidth:0,parentHeight:0,width:0,height:0,viewWidth:0,viewHeight:0,rate:1,loaded:!1},a.fileInfo={},a.virtualPageCache={},a.virtualPageAspecCache={},a.serviceHandle=t,a.viewInfo.sheetName=i,a.init(r,n),a}return i(t,e),t.prototype.setParentWidthHeight=function(e){var t=document.getElementById(e),r=t.clientWidth,n=t.clientHeight;this.viewInfo.parentWidth=r,this.viewInfo.parentHeight=n},t.prototype.drawImg=function(e,t,r,n,i,o,a,s){return new Promise((function(e,t){var c=/https?:\/\//.test(a),u=s.getContext("2d"),f=new Image;f.onload=function(){u.drawImage(f,r,n,i,o),e()},f.src=c?a:"data:image/png;base64,"+a}))},t.prototype.getDocsViewDomId=function(){return"zego-docsview"+this.id},t.prototype.getIFrameId=function(){return"zego-docsview-iframe"+this.id},t.prototype.getCanvasId=function(){return"zego-docsview-canvas"+this.id},t.prototype.createDocsViewParentIfNeeded=function(e){var t=this;if(!document.getElementById(this.getDocsViewDomId())){var r=document.createElement("div");r.id=this.getDocsViewDomId(),r.style.position="absolute",r.addEventListener("pagechange_wb",(function(e){if(e&&e.detail){var r=t.getPageByScrollTop(e.detail.y);t.handlePageChange(r,e.detail)}}));var n=document.getElementById(this.parent);n.style.position="relative",n.appendChild(r),e&&r.addEventListener("scroll",(function(e){t.viewInfo.ticking||(requestAnimationFrame((function(){var n=e.target.scrollTop+2,i=t.getPageByScrollTop(n),o=t.fileInfo.file_list[t.viewInfo.sheet];t.execScrollFileAndDraw(n,t.viewInfo.parentHeight),t.viewInfo.percent=Number((n/t.viewInfo.height).toFixed(2)),t.serviceHandle.triggerEventListener("onScroll",{fileID:t.fileInfo.fileID,fileType:t.getFileType(),fileName:o.file_name,name:o.name||"",percent:t.viewInfo.percent,page:i,y:n}),t.viewInfo.page!==i&&(t.viewInfo.page=i,r.dispatchEvent(new CustomEvent("pagechange_docs",{detail:{page:i,pageCount:t.viewInfo.total,y:n,scroll:!0}}))),t.viewInfo.ticking=!1})),t.viewInfo.ticking=!0)}))}},t.prototype.updateDocsViewParentLayout=function(e,t,r,n){r|=0,n|=0;var i=document.getElementById(this.getDocsViewDomId());i&&(i.style.width=r+"px",i.style.height=n+"px",i.style.left=(0|e)+"px",i.style.top=(0|t)+"px"),this.viewInfo.width=r,this.viewInfo.viewWidth=r,this.viewInfo.viewHeight=n},t.prototype.hideOtherDocsViewParent=function(){var e=document.getElementById(this.parent);if(e){var t=this.getDocsViewDomId();Array.from(e.children).forEach((function(e){e.style.display=e.id==t?"block":"none"}))}},t.prototype.drawImgByPath=function(e,t,r){var n=this;return new Promise((function(i,a){var s=t.getContext("2d"),c=new Image;c.onload=function(){var e={},a=c.width,u=c.height;if(a<640&&u<400){var f=640/a,l=400/u,p=a*(m=Math.min(f,l))|0,d=u*m|0,h=(t.width-p)/2,g=(t.height-d)/2;t.width=p,t.height=d,s.drawImage(c,0,0,a,u,0,0,p,d),e={x:h,y:g,w:p,h:d}}else if(a>1440){n.drawMode=o.RenderMode.PDF;var v=a*n.viewInfo.rate|0,y=u*n.viewInfo.rate|0;t.height=y,s.drawImage(c,0,r,a,u,0,0,v,y),e={x:0,y:0,w:n.viewInfo.parentWidth,h:n.viewInfo.parentHeight}}else if(u/a<=2.2){var m;f=n.viewInfo.parentWidth/a,l=n.viewInfo.parentHeight/u,p=a*(m=Math.min(f,l))|0,d=u*m|0,h=(n.viewInfo.parentWidth-p)/2,g=(n.viewInfo.parentHeight-d)/2;t.width=p,t.height=d,s.drawImage(c,0,0,a,u,0,0,p,d),e={x:h,y:g,w:p,h:d}}else{p=a*n.viewInfo.rate|0,d=u*n.viewInfo.rate|0;t.width=p,t.height=d,s.drawImage(c,0,r,a,u,0,0,p,d),e={x:0,y:r,w:p,h:d}}n.updateDocsViewParentLayout(e.x,e.y,e.w,e.h);var w=n.fileInfo.file_list[n.viewInfo.sheet];w.rate=Number((n.viewInfo.parentWidth/t.width).toFixed(2)),w.max_width=t.width,w.total_height=t.height,n.viewInfo.height=t.height,n.viewInfo.rate=w.rate,i()},c.src=e.image_path}))},t.prototype.drawImgByVPageList=function(e,t,r,n){var i=this;this.drawMode===o.RenderMode.PPT&&(t=0);var a=t;this.createDocsViewParentIfNeeded(this.drawMode!==o.RenderMode.PPT&&!r[0].image_path),this.hideOtherDocsViewParent();var s=this.getCanvasId(),c=document.getElementById(s),u=!c;if(!c){(c=document.createElement("canvas")).id=s,c.width=this.viewInfo.parentWidth;var f=this.getFileType();if(f===o.FileType.PPT){var l=this.virtualPageAspecCache[this.viewInfo.sheet][1];c.width=l.w,c.height=l.h,c.setAttribute("data-page",this.viewInfo.total+""),this.updateDocsViewParentLayout(l.x,l.y,l.w,l.h)}else f===o.FileType.IMG?(this.viewInfo.height=this.viewInfo.parentHeight,c.height=this.viewInfo.parentHeight):(c.height=this.viewInfo.height,this.updateDocsViewParentLayout(0,0,this.viewInfo.parentWidth,this.viewInfo.parentHeight))}r.map((function(e){return e.virtual_page_number})).join();if(this.drawMode===o.RenderMode.PPT){var p=r.find((function(e){return e.virtual_page_number===i.viewInfo.page}));r=p?[p]:[]}for(var d=[],h=0;h<r.length;++h){var g=r[h],v=g.width,y=g.height,m=g.image_data,w=g.image_path;if(m)if(this.drawMode===o.RenderMode.PPT){l=this.virtualPageAspecCache[this.viewInfo.sheet][1];var _=this.drawImg(v,y,0,a,l.w,l.h,m,c);d.push(_)}else{_=this.drawImg(v,y,0,a,v,y,m,c);a+=y,d.push(_)}else if(w){_=this.drawImgByPath(r[0],c,t);d.push(_)}}Promise.all(d).then((function(){var e=document.getElementById(i.getDocsViewDomId());if(e&&u){e.appendChild(c);var t=Number(e.style.height.replace("px",""))+20;e.style.overflowX="hidden",e.style.overflowY=c.height>t?" auto":"hidden"}n&&n()}))},t.prototype.drawHtmlByVPageList=function(e,t){var r=this;this.createDocsViewParentIfNeeded(!1),this.hideOtherDocsViewParent();var n=this.virtualPageAspecCache[this.viewInfo.sheet][1],i=n.x,o=n.y,a=n.w,s=n.h,c=this.getIFrameId(),u=document.getElementById(c),f=!u;if(!u){(u=document.createElement("iframe")).id=c,u.width=a,u.height=s;var l="pointer-events:none;";a>1280&&(l+="transform:scale("+(a/1280).toFixed(2)+");"),u.style.cssText=l,u.setAttribute("data-page",this.viewInfo.total+"")}u.src=e;window.addEventListener("message",(function(e){var t=e.data;t&&"zegodocsview"===t.source&&("currentPage"===t.action?r.viewInfo.page=t.res+1:t.action||r.viewInfo.loaded||(r.viewInfo.loaded=!0,r.postMessage2iframe("gotoPage",[r.viewInfo.page-1])))})),this.updateDocsViewParentLayout(i,o,a,s);var p=document.getElementById(this.getDocsViewDomId());p&&f&&(p.appendChild(u),p.style.overflow="hidden"),t&&t()},t.prototype.getAllVirtualInPageRange=function(e,t,r){for(var n=[],i=0;i<e.length;++i)if(i>=t&&i<r)for(var o=0;o<e[i].virtual_page_list.length;++o)n.push(e[i].virtual_page_list[o].virtual_page_number);return n},t.prototype.startGetImageByVirtualPageList=function(e,t,r,n){for(var i=[],o=0;o<t.length;){var a=this.virtualPageCache[this.viewInfo.sheet]&&this.virtualPageCache[this.viewInfo.sheet][t[o]];a?(i.push(a),t.splice(o,1)):o++}this.getImageByVirtualPageList(i,e,t,r,n)},t.prototype.sortVirtualPageListRule=function(e,t){return e.virtual_page_number-t.virtual_page_number},t.prototype.getImageByVirtualPageList=function(e,t,r,n,i){var o=this;if(r.length<=0)return e.sort(this.sortVirtualPageListRule),void i(e);this.serviceHandle.registerEventHandler(this.id,"onDocsGetPDFPageImage",(function(a){for(var s=0;s<r.length;++s)if(r[s]==a.virtual_page_number){r.splice(s,1);break}o.virtualPageCache[o.viewInfo.sheet]=o.virtualPageCache[o.viewInfo.sheet]||{},o.virtualPageCache[o.viewInfo.sheet][a.virtual_page_number]=a;var c=!1;for(s=0;s<e.length;++s)e[s].virtual_page_number==a.virtual_page_number&&(e[s]=a,c=!0);c||e.push(a),o.getImageByVirtualPageList(e,t,r,n,i)})),this.serviceHandle.getPageImage(this.id,{sheet:this.viewInfo.sheet,file_id:t,virtual_page_number:r[0],rate:n,rotation:0,res:this.fileInfo})},t.prototype.getPageNumberByYPos=function(e,t){for(var r=0,n=0,i=0;i<e.length;++i)for(var o=0;o<e[i].virtual_page_list.length;++o){if((e[i].virtual_page_list[o].height+r)*this.viewInfo.rate>=t)return i;r+=e[i].virtual_page_list[o].height,n=i}return n},t.prototype.getHeightByPage=function(e,t){for(var r=0,n=0;n<e.length&&!(n>=t);++n)for(var i=0;i<e[n].virtual_page_list.length;++i)r+=e[n].virtual_page_list[i].height;return r},t.prototype.execScrollFileAndDraw=function(e,t,r){var n=this,i=this.fileInfo.file_list[this.viewInfo.sheet].page_list,a=Math.min(this.getPageNumberByYPos(i,e),this.viewInfo.page-1),s=Math.max(this.getPageNumberByYPos(i,e+t)+3,this.viewInfo.page),c=this.getAllVirtualInPageRange(i,a,s),u=this.getHeightByPage(i,a)*this.viewInfo.rate;this.startGetImageByVirtualPageList(this.fileInfo.fileID,c,this.viewInfo.rate,(function(e){n.drawMode===o.RenderMode.PPTH5?n.drawHtmlByVPageList(e[0].image_data,r):n.drawImgByVPageList(0,u,e,r)}))},t.prototype.loadCurrentSheet=function(){var e=this,t=this.fileInfo.file_list[this.viewInfo.sheet];if(t){var r=this.getFileType();if(this.viewInfo.width=t.max_width,this.viewInfo.height=t.total_height,this.viewInfo.total=t.page_count,this.viewInfo.rate=t.rate,r===o.FileType.PPT?this.drawMode=o.RenderMode.PPT:r===o.FileType.PPTH5?this.drawMode=o.RenderMode.PPTH5:this.drawMode=o.RenderMode.PDF,r===o.FileType.ELS){var n=document.getElementById(this.getCanvasId());n&&(n.width=this.viewInfo.width,n.height=this.viewInfo.height)}this.execScrollFileAndDraw(0,this.viewInfo.parentHeight,(function(){var n,i={fileID:e.fileInfo.user_data,fileName:t.file_name,fileType:r,pageCount:t.page_count,viewID:e.getDocsViewDomId()},a=((n={fileID:i.fileID})[i.fileName]={width:e.viewInfo.width,height:e.viewInfo.height,pageCount:i.pageCount},n);r===o.FileType.ELS&&(i.name=t.name,i.sheets=e.fileInfo.file_list.map((function(e){return a[e.file_name]={width:e.max_width,height:e.total_height,pageCount:e.page_count},e.file_name}))),document.body.dispatchEvent(new CustomEvent("loadfile",{detail:a})),e.serviceHandle.triggerEventListener("onLoadFile",i)}))}},t.prototype.init=function(e,t){var r=this;this.parent=e,this.id=t,this.serviceHandle.registerEventHandler(t,"onDocsUploading",(function(e){0==e.error_code?r.serviceHandle.triggerEventListener("onUpload",{uploadPercent:100*e.rate}):r.serviceHandle.triggerEventListener("onUpload",{fileID:e.file_id,uploadPercent:100})})),this.serviceHandle.registerEventHandler(t,"onDocsConvertStatus",(function(e){16==e.convert_status&&r.serviceHandle.triggerEventListener("onUpload",{fileID:e.file_id,uploadPercent:100})})),this.serviceHandle.registerEventHandler(t,"onDocsLoadPdf",(function(e){r.setParentWidthHeight(r.parent);for(var t=e.document_type,n=0;n<e.file_list.length;++n){r.virtualPageAspecCache[n]={};var i=e.file_list[n];if(t===o.FileType.ELS?(i.page_count=i.page_list.length,i.file_name=i.file_name.replace(/\.[a-zA-Z]+$/,""),i.file_name===r.viewInfo.sheetName&&(r.viewInfo.sheet=n)):i.page_count=e.page_count||i.page_list.length,t===o.FileType.PPTH5&&i.file_url){var a=i.page_list[0],s=a.width,c=a.height;i.page_list=[{width:s,height:c,virtual_page_list:[{width:s,height:c,virtual_page_number:1}]}],i.max_width=s}else{for(var u=0,f=0;f<i.page_list.length;++f){(s=i.page_list[f].width)>u&&(u=s)}i.max_width=u}if(i.rate=Number((r.viewInfo.parentWidth/i.max_width).toFixed(2)),t===o.FileType.PPTH5||t===o.FileType.PPT||t===o.FileType.IMG){var l=r.viewInfo.parentWidth,p=i.page_list[0].height*l/i.max_width|0;p>r.viewInfo.parentHeight&&(l=r.viewInfo.parentHeight*r.viewInfo.parentWidth/p|0,p=r.viewInfo.parentHeight);var d={x:(r.viewInfo.parentWidth-l)/2,y:(r.viewInfo.parentHeight-p)/2,w:l,h:p};for(f=0;f<i.page_count;++f)r.virtualPageAspecCache[n][f+1]=d;i.max_width=l,i.total_height=p*i.page_count}else{var h=0;for(f=0;f<i.page_list.length;++f){var g=i.page_list[f].height*r.viewInfo.parentWidth/i.max_width|0;h+=g,r.virtualPageAspecCache[n][f+1]={x:0,y:0,w:r.viewInfo.parentWidth,h:g}}i.max_width=r.viewInfo.parentWidth,i.total_height=h}}Object.assign(r.fileInfo,e),r.loadCurrentSheet()}))},t.prototype.handleScroll=function(e,t){var r=this,n=document.getElementById(this.getDocsViewDomId()),i=this.drawMode===o.RenderMode.PDF;n&&(this.drawMode===o.RenderMode.PPT?this.execScrollFileAndDraw(e,this.viewInfo.viewHeight):i&&!this.viewInfo.ticking&&(this.viewInfo.ticking=!0,n.scrollTo(0,e),setTimeout((function(){r.viewInfo.ticking=!1}),34)),n.dispatchEvent(new CustomEvent("pagechange_docs",{detail:{page:this.viewInfo.page,pageCount:this.viewInfo.total,y:e,scroll:i,notify:t}})))},t.prototype.getScrollTopByPage=function(){var e=0;if(this.drawMode===o.RenderMode.PPT||this.drawMode===o.RenderMode.PPTH5)e=(this.viewInfo.page-1)*this.viewInfo.viewHeight;else for(var t=this.virtualPageAspecCache[this.viewInfo.sheet],r=1;r<this.viewInfo.page;r++)e+=t[r].h;return e+2},t.prototype.getPageByScrollTop=function(e){var t=this.getFileType(),r=this.viewInfo.viewHeight/2;if(t===o.FileType.IMG||e<=r)return 1;if(t===o.FileType.PPT||t===o.FileType.PPTH5)return Math.round(e/this.viewInfo.viewHeight)+1;for(var n=this.virtualPageAspecCache[this.viewInfo.sheet],i=-r,a=1;i<=e&&n[a];)i+=n[a].h,a++;return a-1},t.prototype.postMessage2iframe=function(e,t){var r=document.getElementById(this.getIFrameId());r&&r.contentWindow&&r.contentWindow.postMessage({source:"zegodocsview",action:e,args:t||[]},"*")},t.prototype.handlePageChange=function(e,t){e!==this.viewInfo.page?(this.viewInfo.page=e-1,this.viewInfo.total>1&&this.viewInfo.page<this.viewInfo.total&&(this.viewInfo.page+=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(t.y,!t.push))):this.handleScroll(t.y,!t.push)},t.prototype.setSheetName=function(e){this.viewInfo.sheetName=e},t.prototype.loadFile=function(e,t){return this.virtualPageCache={},this.virtualPageAspecCache={},this.fileInfo.fileID=e,this.fileInfo.authKey=t,this.viewInfo.ticking=!1,this.serviceHandle.load(this.id,{fileID:e,authKey:t})},t.prototype.getContentSize=function(){return{width:this.viewInfo.width,height:this.viewInfo.height}},t.prototype.getVisibleSize=function(){return{width:this.viewInfo.viewWidth,height:this.viewInfo.viewHeight}},t.prototype.getFileID=function(){return this.fileInfo.fileID},t.prototype.getFileType=function(){return this.fileInfo.document_type},t.prototype.getCurrentPage=function(){return this.viewInfo.page},t.prototype.getPageCount=function(){return this.viewInfo.total},t.prototype.getVerticalPercent=function(){return this.viewInfo.percent},t.prototype.scrollTo=function(e){var t=Math.ceil(e*this.viewInfo.height),r=this.getPageByScrollTop(t);r!==this.viewInfo.page&&(this.viewInfo.page=r-1,this.nextPage())},t.prototype.flipPage=function(e){var t=this.getPageCount();e<1?e=1:e>t?e=t:e|=0,e!==this.viewInfo.page&&(this.viewInfo.page=e-1,this.nextPage())},t.prototype.previousPage=function(){this.viewInfo.total>1&&this.viewInfo.page>1&&(this.viewInfo.page-=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(this.getScrollTopByPage(),!0))},t.prototype.nextPage=function(){this.viewInfo.total>1&&this.viewInfo.page<this.viewInfo.total&&(this.viewInfo.page+=1,this.drawMode===o.RenderMode.PPTH5&&this.postMessage2iframe("gotoPage",[this.viewInfo.page-1]),this.handleScroll(this.getScrollTopByPage(),!0))},t.prototype.previousStep=function(){this.postMessage2iframe("previousStep"),this.postMessage2iframe("currentPage")},t.prototype.nextStep=function(){this.postMessage2iframe("nextStep"),this.postMessage2iframe("currentPage")},t.prototype.loadSheet=function(e){this.getFileType()===o.FileType.ELS&&e>=0&&e<this.fileInfo.file_list.length&&(this.viewInfo.sheet=e,this.loadCurrentSheet())},t}(r(53).ZegoDocsView);t.ZegoDocsViewMod=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsView=void 0;var n=function(){};t.ZegoDocsView=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewService=void 0;var o=r(55),a=r(19),s=function(e){function t(t){var r=e.call(this)||this;return r.listeners={},r.zegoDocs=t,r}return i(t,e),t.prototype.setTestEnv=function(e){this.zegoDocs.setTestEnv(e)},t.prototype.setConfig=function(e,t){return this.zegoDocs.setConfig(e,t)},t.prototype.getConfig=function(e){return this.zegoDocs.getConfig(e)},t.prototype.registerEventHandler=function(e,t,r){this.listeners[t]=this.listeners[t]||{},this.listeners[t][e]=r},t.prototype.load=function(e,t){var r=this;return this.zegoDocs.load(t).then((function(t){return setTimeout((function(){var n=r.listeners.onDocsLoadPdf[e];n&&n(r.transLoadFile(t))})),t}))},t.prototype.upload=function(e){var t=this;return e.onProgress=function(e){t.triggerEventListener("onUpload",e)},this.zegoDocs.upload(e)},t.prototype.init=function(e){},t.prototype.setLogFolder=function(e){},t.prototype.setCacheDirectory=function(e){},t.prototype.getPageImage=function(e,t){var r=this.listeners.onDocsGetPDFPageImage[e];r&&r(this.transImage(t))},t.prototype.transLoadFile=function(e){var t=e.width,r=e.height,n=e.fileType===a.FileType.ELS?e.file_list:[{file_name:e.fileName,page_list:e.fileUrls.map((function(e,n){return{width:t,height:r,src:e,virtual_page_list:[{width:t,height:r,virtual_page_number:n+1}]}}))}];return{user_data:e.fileID,document_type:e.fileType,page_count:e.pageCount,file_list:n}},t.prototype.transImage=function(e){var t=e.file_id,r=e.virtual_page_number,n=e.rate,i=e.res,o=e.sheet,s=i.document_type===a.FileType.IMG,c=i.file_list[o].page_list[r-1],u=c.width,f=c.height,l=c.src;return{error_code:0,file_id:t,width:u*n|0,height:f*n|0,image_data:s?"":l,image_path:s?l:"",virtual_page_number:r}},t}(o.ZegoDocsViewServiceBase);t.ZegoDocsViewService=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewServiceBase=void 0;var n=function(){function e(){this.customListeners={onLoadFile:[],onUpload:[],onScroll:[]}}return e.prototype.addEventListener=function(e,t){return!!this.customListeners[e]&&("function"==typeof t&&(-1==this.customListeners[e].indexOf(t)&&this.customListeners[e].push(t),!0))},e.prototype.removeEventListener=function(e,t){if(!this.customListeners[e])return!1;var r=this.customListeners[e];return t?r.splice(r.indexOf(t),1):this.customListeners[e]=[],!0},e.prototype.triggerEventListener=function(e,t){this.customListeners[e].forEach((function(e){return e(t)}))},e}();t.ZegoDocsViewServiceBase=n}])}));